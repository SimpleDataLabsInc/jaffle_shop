{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final_with_order##QTve3LMM","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"customer_orders##v8oHqz4x":{"id":"customer_orders##v8oHqz4x","component":"Aggregate","metadata":{"label":"customer_orders","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"cWzTi4y5","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"OrDXPeIn","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Bigint"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"orders##KAKrptt2":{"id":"orders##KAKrptt2","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"fHJ7FLiY","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_report##JJPGPx03":{"id":"customer_report##JJPGPx03","component":"Join","metadata":{"label":"customer_report","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"amount_per_customer","expression":{"expression":"customers.customer_id = amount_per_customer.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"},"alias":"total_orders"},{"expression":{"expression":"amount_per_customer.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"customers"},"ports":{"inputs":[{"id":"uVg9aF7a","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"customers"},{"id":"YCGQY0zZ","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Bigint"}}]},"slug":"customer_orders"},{"id":"jxD5CiS2","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Double"}}]},"slug":"amount_per_customer"}],"outputs":[{"id":"yJgkUpoH","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Bigint"}},{"name":"customer_lifetime_value","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final_with_order##QTve3LMM":{"id":"final_with_order##QTve3LMM","component":"OrderBy","metadata":{"label":"final_with_order","phase":0,"macroDependencies":[]},"properties":{"columnsSelector":[],"orders":[{"expression":{"expression":"total_orders"},"sortType":"desc"}]},"ports":{"inputs":[{"id":"VqqnaXpJ","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Bigint"}},{"name":"customer_lifetime_value","dataType":{"type":"Double"}}]},"slug":"customer_report"}],"outputs":[{"id":"YTUBrm2J","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Bigint"}},{"name":"customer_lifetime_value","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customers##fXrD7c9U":{"id":"customers##fXrD7c9U","component":"Model","metadata":{"label":"customers","phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"ks9EfV9J","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"payments##ROLjnzXw":{"id":"payments##ROLjnzXw","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"yYmLAJfN","schema":{"providerType":"Databricks","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##Nfe785kc":{"id":"customer_payments##Nfe785kc","component":"Join","metadata":{"label":"customer_payments","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"orders","expression":{"expression":"payments.order_id = orders.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.customer_id"},"alias":"customer_id"},{"expression":{"expression":"amount"}}],"activeTab":"conditions","columnsSelector":[],"headAlias":"payments"},"ports":{"inputs":[{"id":"HhahadGl","schema":{"providerType":"Databricks","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Double"}}]},"slug":"payments"},{"id":"Oe8elFXd","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"KDa4QxjJ","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"amount_per_customer##MKRFZqIB":{"id":"amount_per_customer##MKRFZqIB","component":"Aggregate","metadata":{"label":"amount_per_customer","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"D08Dbom0","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"customer_payments"}],"outputs":[{"id":"XB7rLLMS","schema":{"providerType":"Databricks","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"VczF9i7D","source":"payments##ROLjnzXw","sourcePort":"yYmLAJfN","target":"customer_payments##Nfe785kc","targetPort":"HhahadGl"},{"id":"xNKR4Fle","source":"orders##KAKrptt2","sourcePort":"fHJ7FLiY","target":"customer_payments##Nfe785kc","targetPort":"Oe8elFXd"},{"id":"AYcOpKpq","source":"customer_payments##Nfe785kc","sourcePort":"KDa4QxjJ","target":"amount_per_customer##MKRFZqIB","targetPort":"D08Dbom0"},{"id":"iZE3Xhz1","source":"orders##KAKrptt2","sourcePort":"fHJ7FLiY","target":"customer_orders##v8oHqz4x","targetPort":"cWzTi4y5"},{"id":"T9hBLixi","source":"customers##fXrD7c9U","sourcePort":"ks9EfV9J","target":"customer_report##JJPGPx03","targetPort":"uVg9aF7a"},{"id":"Fy2p8MC4","source":"customer_orders##v8oHqz4x","sourcePort":"OrDXPeIn","target":"customer_report##JJPGPx03","targetPort":"YCGQY0zZ"},{"id":"yvIMnT83","source":"amount_per_customer##MKRFZqIB","sourcePort":"XB7rLLMS","target":"customer_report##JJPGPx03","targetPort":"jxD5CiS2"},{"id":"mf9lxPnB","source":"customer_report##JJPGPx03","sourcePort":"yJgkUpoH","target":"final_with_order##QTve3LMM","targetPort":"VqqnaXpJ"}],"component":"Model"}
{"id":"customers","metainfo":{"label":"customers","finalProcessID":"final_with_order##7AhALg3m","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"amount_per_customer##0oyccFt8":{"id":"amount_per_customer##0oyccFt8","component":"Aggregate","metadata":{"label":"amount_per_customer","x":540,"y":520,"phase":0},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"T0hSqK1v","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"customer_payments"}],"outputs":[{"id":"vAzMVwmo","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"orders##nHOsBWLa":{"id":"orders##nHOsBWLa","component":"Model","metadata":{"label":"orders","x":120,"y":320,"phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"UwimEbUN","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"k-55NIqsuSCtJs78Hti99":{"id":"k-55NIqsuSCtJs78Hti99","component":"Source","metadata":{"label":"customers","slug":"customers","x":420,"y":100,"phase":0},"properties":{"table":{"name":"stg_customers","sourceType":"Source","sourceName":"prophecy-development.dataset","alias":"","additionalProperties":null}},"ports":{"inputs":[],"outputs":[{"id":"3-6WVdkquW_fZ2Xk0R-8k","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_payments##BLO4axRo":{"id":"customer_payments##BLO4axRo","component":"Join","metadata":{"label":"customer_payments","x":340,"y":520,"phase":0},"properties":{"conditions":[{"alias":"orders","expression":{"expression":"payments.order_id = orders.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.customer_id"},"alias":"customer_id"},{"expression":{"expression":"amount"}}],"activeTab":"conditions","columnsSelector":[],"headAlias":"payments"},"ports":{"inputs":[{"id":"DJ4rL09S","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"payments"},{"id":"TQL8qsDi","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"1Qzw5lsx","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final_with_order##7AhALg3m":{"id":"final_with_order##7AhALg3m","component":"OrderBy","metadata":{"label":"final_with_order","x":960,"y":240,"phase":0},"properties":{"columnsSelector":[],"orders":[{"expression":{"expression":"total_orders"},"sortType":"desc","nullsType":""}]},"ports":{"inputs":[{"id":"GpnXYR5P","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"customer_report"}],"outputs":[{"id":"AfGGaOaO","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"payments##NU6acIrG":{"id":"payments##NU6acIrG","component":"Model","metadata":{"label":"payments","x":120,"y":520,"phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"vBbvzuta","schema":{"providerType":"BigQuery","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_orders##WBGLPmfj":{"id":"customer_orders##WBGLPmfj","component":"Aggregate","metadata":{"label":"customer_orders","x":540,"y":320,"phase":0},"properties":{"aggregate":[{"expression":{"expression":"customer_id"}},{"expression":{"expression":"min(order_date)"},"alias":"first_order"},{"expression":{"expression":"max(order_date)"},"alias":"most_recent_order"},{"expression":{"expression":"count(order_id)"},"alias":"number_of_orders"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":["DNPmLxzI##customer_id","DNPmLxzI##order_date","DNPmLxzI##order_id"],"groupBy":[{"expression":{"expression":"customer_id"}}]},"ports":{"inputs":[{"id":"DNPmLxzI","schema":{"providerType":"BigQuery","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"}],"outputs":[{"id":"Qv7hTFFa","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"customer_report##J39lotZx":{"id":"customer_report##J39lotZx","component":"Join","metadata":{"label":"customer_report","x":740,"y":240,"phase":0},"properties":{"conditions":[{"alias":"customer_orders","expression":{"expression":"customers.customer_id = customer_orders.customer_id"},"joinType":"LEFT"},{"alias":"amount_per_customer","expression":{"expression":"customers.customer_id = amount_per_customer.customer_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"customers.customer_id"}},{"expression":{"expression":"customers.first_name"}},{"expression":{"expression":"customers.last_name"}},{"expression":{"expression":"customer_orders.first_order"}},{"expression":{"expression":"customer_orders.most_recent_order"}},{"expression":{"expression":"customer_orders.number_of_orders"},"alias":"total_orders"},{"expression":{"expression":"amount_per_customer.total_amount"},"alias":"customer_lifetime_value"}],"activeTab":"conditions","columnsSelector":["5zHJtZZ7##customer_id","eNC59kWJ##customer_id","XUKVgoPQ##customer_id","5zHJtZZ7##customer_id","5zHJtZZ7##first_name","5zHJtZZ7##last_name","eNC59kWJ##first_order","eNC59kWJ##most_recent_order","eNC59kWJ##number_of_orders","XUKVgoPQ##total_amount"],"headAlias":"customers"},"ports":{"inputs":[{"id":"5zHJtZZ7","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}}]},"slug":"customers"},{"id":"eNC59kWJ","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"number_of_orders","dataType":{"type":"Integer"}}]},"slug":"customer_orders"},{"id":"XUKVgoPQ","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"total_amount","dataType":{"type":"Float"}}]},"slug":"amount_per_customer"}],"outputs":[{"id":"uFwnFPKF","schema":{"providerType":"BigQuery","fields":[{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"first_name","dataType":{"type":"String"}},{"name":"last_name","dataType":{"type":"String"}},{"name":"first_order","dataType":{"type":"Date"}},{"name":"most_recent_order","dataType":{"type":"Date"}},{"name":"total_orders","dataType":{"type":"Integer"}},{"name":"customer_lifetime_value","dataType":{"type":"Float"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"i24X0yA6","source":"payments##NU6acIrG","sourcePort":"vBbvzuta","target":"customer_payments##BLO4axRo","targetPort":"DJ4rL09S"},{"id":"fnZOWkqO","source":"orders##nHOsBWLa","sourcePort":"UwimEbUN","target":"customer_payments##BLO4axRo","targetPort":"TQL8qsDi"},{"id":"XsoLXHHg","source":"customer_payments##BLO4axRo","sourcePort":"1Qzw5lsx","target":"amount_per_customer##0oyccFt8","targetPort":"T0hSqK1v"},{"id":"nqGdSg3z","source":"orders##nHOsBWLa","sourcePort":"UwimEbUN","target":"customer_orders##WBGLPmfj","targetPort":"DNPmLxzI"},{"id":"tf1dPGAp","source":"customer_report##J39lotZx","sourcePort":"uFwnFPKF","target":"final_with_order##7AhALg3m","targetPort":"GpnXYR5P"},{"id":"E_teeBSyAVGjfaLdW57tR","source":"k-55NIqsuSCtJs78Hti99","sourcePort":"3-6WVdkquW_fZ2Xk0R-8k","target":"customer_report##J39lotZx","targetPort":"5zHJtZZ7"},{"id":"QX2h8X8zoJTO7gnFfquKl","source":"customer_orders##WBGLPmfj","sourcePort":"Qv7hTFFa","target":"customer_report##J39lotZx","targetPort":"eNC59kWJ"},{"id":"FS-sHjQSuj04G-uO_r2xS","source":"amount_per_customer##0oyccFt8","sourcePort":"vAzMVwmo","target":"customer_report##J39lotZx","targetPort":"XUKVgoPQ"}],"component":"Model"}
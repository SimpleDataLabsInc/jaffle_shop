{"id":"orders","metainfo":{"label":"orders","finalProcessID":"final##XWXj5cPh","autoLayout":true,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"orders##WkhAqifU":{"id":"orders##WkhAqifU","component":"Model","metadata":{"label":"orders","phase":0},"properties":{"table":{"name":"stg_orders","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"TSV0cD3H","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"payments##EunEl1t9":{"id":"payments##EunEl1t9","component":"Model","metadata":{"label":"payments","phase":0},"properties":{"table":{"name":"stg_payments","sourceType":"Model"}},"ports":{"inputs":[],"outputs":[{"id":"sDagOqP4","schema":{"providerType":"Databricks","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"order_payments##UvQqGw4z":{"id":"order_payments##UvQqGw4z","component":"Aggregate","metadata":{"label":"order_payments","phase":0,"macroDependencies":[]},"properties":{"aggregate":[{"expression":{"expression":"order_id"}},{"expression":{"expression":"sum(CASE\n  WHEN payment_method = 'credit_card'\n    THEN amount\n  ELSE 0\nEND)"},"alias":"credit_card_amount"},{"expression":{"expression":"sum(CASE\n  WHEN payment_method = 'coupon'\n    THEN amount\n  ELSE 0\nEND)"},"alias":"coupon_amount"},{"expression":{"expression":"sum(CASE\n  WHEN payment_method = 'bank_transfer'\n    THEN amount\n  ELSE 0\nEND)"},"alias":"bank_transfer_amount"},{"expression":{"expression":"sum(CASE\n  WHEN payment_method = 'gift_card'\n    THEN amount\n  ELSE 0\nEND)"},"alias":"gift_card_amount"},{"expression":{"expression":"sum(amount)"},"alias":"total_amount"}],"allowSelection":true,"condition":{"expression":""},"activeTab":"aggregate","columnsSelector":[],"groupBy":[{"expression":{"expression":"order_id"}}]},"ports":{"inputs":[{"id":"rZtsfnWR","schema":{"providerType":"Databricks","fields":[{"name":"payment_id","dataType":{"type":"Integer"}},{"name":"order_id","dataType":{"type":"Integer"}},{"name":"payment_method","dataType":{"type":"String"}},{"name":"amount","dataType":{"type":"Double"}}]},"slug":"payments"}],"outputs":[{"id":"eXJGyX4i","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"credit_card_amount","dataType":{"type":"Double"}},{"name":"coupon_amount","dataType":{"type":"Double"}},{"name":"bank_transfer_amount","dataType":{"type":"Double"}},{"name":"gift_card_amount","dataType":{"type":"Double"}},{"name":"total_amount","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"final##XWXj5cPh":{"id":"final##XWXj5cPh","component":"Join","metadata":{"label":"final","phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"order_payments","expression":{"expression":"orders.order_id = order_payments.order_id"},"joinType":"LEFT"}],"expressions":[{"expression":{"expression":"orders.order_id"}},{"expression":{"expression":"orders.customer_id"}},{"expression":{"expression":"orders.order_date"}},{"expression":{"expression":"orders.status"}},{"expression":{"expression":"order_payments.credit_card_amount"}},{"expression":{"expression":"order_payments.coupon_amount"}},{"expression":{"expression":"order_payments.bank_transfer_amount"}},{"expression":{"expression":"order_payments.gift_card_amount"}},{"expression":{"expression":"order_payments.total_amount"},"alias":"amount"}],"activeTab":"conditions","columnsSelector":[],"headAlias":"orders"},"ports":{"inputs":[{"id":"dwtzZ67K","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"orders"},{"id":"zRFNnxbF","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"credit_card_amount","dataType":{"type":"Double"}},{"name":"coupon_amount","dataType":{"type":"Double"}},{"name":"bank_transfer_amount","dataType":{"type":"Double"}},{"name":"gift_card_amount","dataType":{"type":"Double"}},{"name":"total_amount","dataType":{"type":"Double"}}]},"slug":"order_payments"}],"outputs":[{"id":"nRG4slBi","schema":{"providerType":"Databricks","fields":[{"name":"order_id","dataType":{"type":"Integer"}},{"name":"customer_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}},{"name":"credit_card_amount","dataType":{"type":"Double"}},{"name":"coupon_amount","dataType":{"type":"Double"}},{"name":"bank_transfer_amount","dataType":{"type":"Double"}},{"name":"gift_card_amount","dataType":{"type":"Double"}},{"name":"amount","dataType":{"type":"Double"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"fk8vDO8V","source":"payments##EunEl1t9","sourcePort":"sDagOqP4","target":"order_payments##UvQqGw4z","targetPort":"rZtsfnWR"},{"id":"Z307hBuI","source":"orders##WkhAqifU","sourcePort":"TSV0cD3H","target":"final##XWXj5cPh","targetPort":"dwtzZ67K"},{"id":"m8OknGE4","source":"order_payments##UvQqGw4z","sourcePort":"eXJGyX4i","target":"final##XWXj5cPh","targetPort":"zRFNnxbF"}],"component":"Model"}